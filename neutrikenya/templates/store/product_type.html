{% extends 'base.html' %}
{% load static %}

{% block title %}{{ page_title }} - NeutriKenya{% endblock %}

{% block extra_css %}
<style>
    .limited-offer-banner {
        background: linear-gradient(135deg, #f2f2f2 0%, #d9d9d9 100%);
        padding: 15px;
        text-align: center;
        color: #333;
        position: relative;
        overflow: hidden;
        font-weight: 600;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        margin-bottom: 20px;
        border: 2px dashed #fff;
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% { box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        50% { box-shadow: 0 4px 18px rgba(0,0,0,0.3); }
        100% { box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    }
    
    .limited-offer-banner::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        animation: shine 2s infinite;
    }
    
    @keyframes shine {
        100% {
            left: 100%; 
        }
    }
    
    .countdown-container {
        display: flex;
        justify-content: center;
        margin: 15px 0;
        gap: 10px;
    }
    
    .countdown-item {
        background: #333;
        color: white;
        padding: 8px 12px;
        border-radius: 5px;
        min-width: 50px;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    .countdown-value {
        font-size: 1.2rem;
        font-weight: bold;
    }
    
    .countdown-label {
        font-size: 0.7rem;
        text-transform: uppercase;
    }
    
    .product-card {
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.25s ease-out;
        position: relative;
        border: 1px solid rgba(0,0,0,0.05);
        background: white;
        height: 100%;
        box-shadow: 0 4px 10px rgba(0,0,0,0.04);
        max-height: 350px;
    }
    
    .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(212, 175, 55, 0.15);
        border-color: rgba(212, 175, 55, 0.3);
    }
    
    .best-seller-badge, .flash-sale-badge {
        position: absolute;
        top: 12px;
        padding: 0.25rem 0.6rem;
        z-index: 10;
        font-weight: 600;
        font-size: 0.7rem;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        border-radius: 4px;
        letter-spacing: 0.5px;
    }
    
    .best-seller-badge {
        right: 12px;
        background-color: #d4af37;
        color: white;
    }
    
    .flash-sale-badge {
        left: 12px;
        background-color: #e74c3c;
        color: white;
    }
    
    .product-img-container {
        position: relative;
        padding-top: 85%;
        overflow: hidden;
        background: #f8f9fa;
    }
    
    .product-img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: all 0.5s ease;
    }
    
    .product-card:hover .product-img {
        transform: scale(1.07);
    }
    
    .product-info {
        padding: 0.75rem 0.85rem;
        text-align: center;
        background: white;
        display: flex;
        flex-direction: column;
        height: calc(100% - 85%);
        gap: 4px;
        position: relative;
    }
    
    .product-title {
        font-weight: 600;
        font-size: 0.9rem;
        margin-bottom: 5px;
        color: #333;
        height: 2.4rem;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }
    
    .product-price {
        font-weight: 700;
        font-size: 1.1rem;
        color: #d4af37;
        margin: 0;
        line-height: 1.2;
    }
    
    .product-original-price {
        text-decoration: line-through;
        color: #999;
        margin-right: 0.4rem;
        font-size: 0.85rem;
    }
    
    .product-discount {
        background: #e74c3c;
        color: white;
        padding: 3px 6px;
        border-radius: 3px;
        font-size: 0.75rem;
        margin-left: 5px;
        animation: blinker 1s linear infinite;
    }
    
    @keyframes blinker {
        50% { opacity: 0.7; }
    }
    
    .product-rating {
        color: #d4af37;
        margin-bottom: 3px;
    }
    
    .product-rating span {
        letter-spacing: 2px; 
    }
    
    .add-to-cart-btn {
        background: linear-gradient(to right, #d4af37, #c19d2f);
        color: white;
        border: none;
        border-radius: 4px;
        font-weight: 600;
        font-size: 0.8rem;
        padding: 7px;
        margin-top: 0;
        transition: all 0.2s ease;
        width: 100%;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .add-to-cart-btn:hover {
        background: linear-gradient(to right, #c19d2f, #b18d1f);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(212, 175, 55, 0.25);
    }
    
    .stock-status {
        display: inline-block;
        padding: 3px 8px;
        border-radius: 3px;
        font-size: 0.75rem;
        font-weight: 600;
        margin-bottom: 5px;
    }
    
    .in-stock {
        background: rgba(46, 204, 113, 0.1);
        color: #2ecc71;
    }
    
    .low-stock {
        background: rgba(243, 156, 18, 0.1);
        color: #f39c12;
        animation: pulse-warning 2s infinite;
    }
    
    @keyframes pulse-warning {
        0% { opacity: 1; }
        50% { opacity: 0.7; }
        100% { opacity: 1; }
    }
    
    .out-of-stock {
        background: rgba(231, 76, 60, 0.1);
        color: #e74c3c;
    }
    
    .trust-badges {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 30px 0;
    }
    
    .trust-badge {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
    }
    
    .trust-badge i {
        font-size: 1.5rem;
        margin-bottom: 10px;
        color: #333;
    }
    
    .trust-badge span {
        font-size: 0.8rem;
        color: #666;
    }
    
    .skin-type-filter {
        margin-bottom: 20px;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
    }
    
    .skin-type-btn {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        color: #333;
        padding: 8px 16px;
        border-radius: 30px;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .skin-type-btn:hover, .skin-type-btn.active {
        background: #d4af37;
        color: white;
        border-color: #d4af37;
    }
    
    .products-wrapper {
        margin-top: 30px;
    }
    
    .featured-product-banner {
        background: linear-gradient(135deg, #f2f2f2 0%, #d9d9d9 100%);
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .featured-product-banner h3 {
        color: #333;
        margin-bottom: 15px;
    }
    
    .featured-product-banner .btn {
        background: #d4af37;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .featured-product-banner .btn:hover {
        background: #c19d2f;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.15);
    }

    .btn-dark {
        background-color: #d4af37 !important; /* Gold color */
        border-color: #d4af37 !important;
        color: white !important;
    }

    .btn-dark:hover {
        background-color: #c19d2f !important; /* Darker gold */
        border-color: #c19d2f !important;
    }

    /* WhatsApp button */
    .position-fixed a.btn {
        background-color: #d4af37 !important; /* Gold color */
        border-color: #d4af37 !important;
    }

    /* Quick view button */
    .quick-view {
        position: absolute;
        top: 10px;
        right: 10px;
        opacity: 0;
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        background-color: white;
        color: #d4af37;
        border: none;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
        box-shadow: 0 3px 8px rgba(0,0,0,0.15);
        font-size: 0.8rem;
        border-radius: 50%;
        transform: translateY(-5px);
    }

    .quick-view:hover {
        background-color: #d4af37;
        color: white;
        transform: scale(1.1);
    }

    .product-card:hover .quick-view {
        opacity: 1;
        transform: translateY(0);
    }

    .d-flex.justify-content-center.align-items-center.mb-3 {
        margin-bottom: 5px !important;
    }

    .product-actions {
        display: flex;
        flex-direction: column;
        gap: 6px;
        padding-top: 5px;
    }

    .btn-outline-dark {
        border: 1.5px solid #d4af37;
        color: #d4af37;
        background-color: transparent;
        border-radius: 4px;
        font-weight: 600;
        font-size: 0.8rem;
        padding: 0.25rem 0.5rem;
        transition: all 0.2s ease;
        margin-bottom: 0 !important;
    }

    .btn-outline-dark:hover {
        background-color: #d4af37;
        color: white;
        transform: translateY(-2px);
    }
</style>
{% endblock %}

{% block content %}
<!-- Limited Time Offer Banner -->
<div class="container mt-4">
    <div class="limited-offer-banner">
        <h4 class="mb-2">âš¡ FLASH SALE: 15% OFF ALL {{ current_category|upper }} PRODUCTS!</h4>
        <p class="mb-2">Use code <strong>{% if current_category == 'Cleanser' %}CLEAN15{% elif current_category == 'Toner' %}TONE15{% elif current_category == 'Face Cream' %}CREAM15{% elif current_category == 'Body Wash' %}BODY15{% else %}SAVE15{% endif %}</strong> at checkout â€¢ <span class="fw-bold text-danger">ENDING SOON!</span></p>
        <div class="countdown-container">
            <div class="countdown-item">
                <div class="countdown-value" id="days">01</div>
                <div class="countdown-label">days</div>
            </div>
            <div class="countdown-item">
                <div class="countdown-value" id="hours">11</div>
                <div class="countdown-label">hours</div>
            </div>
            <div class="countdown-item">
                <div class="countdown-value" id="minutes">45</div>
                <div class="countdown-label">mins</div>
            </div>
            <div class="countdown-item">
                <div class="countdown-value" id="seconds">30</div>
                <div class="countdown-label">secs</div>
            </div>
        </div>
        <p class="mb-0"><small>ðŸ”¥ <span class="fw-bold">82 people</span> bought this today - Don't miss out!</small></p>
    </div>
</div>

<!-- Products Section -->
<section class="py-5" id="products-section">
    <div class="container">
        <div class="row mb-5">
            <div class="col-lg-6">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-3">
                        <li class="breadcrumb-item"><a href="{% url 'store:home' %}">Home</a></li>
                        <li class="breadcrumb-item"><a href="{% url 'store:shop' %}">Shop</a></li>
                        <li class="breadcrumb-item active" aria-current="page">{{ current_category }}</li>
                    </ol>
                </nav>
                <span class="badge bg-dark mb-2">BEST SELLER CATEGORY</span>
                <h1 class="display-5 fw-bold mb-3">{{ page_title }}</h1>
                <p class="lead mb-4">{{ page_description }}</p>
                
                <!-- Trust Badges -->
                <div class="trust-badges mb-4">
                    <div class="trust-badge">
                        <i class="fas fa-truck"></i>
                        <span>Fast Delivery</span>
                    </div>
                    <div class="trust-badge">
                        <i class="fas fa-undo"></i>
                        <span>30-Day Returns</span>
                    </div>
                    <div class="trust-badge">
                        <i class="fas fa-shield-alt"></i>
                        <span>100% Authentic</span>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                {% if current_category == 'Cleanser' %}
                <div class="featured-product-banner">
                    <div class="row align-items-center">
                        <div class="col-md-7">
                            <h3>Our Best-Selling Cleanser</h3>
                            <p>Vitamin C Face Cleanser - Soothes And Purifies For Super Clean</p>
                            <p><strong>Key Benefits:</strong></p>
                            <ul>
                                <li>Removes makeup and impurities</li>
                                <li>Contains Vitamin C for brightening</li>
                                <li>Gentle amino acid cleansing agents</li>
                                <li>Soothes and purifies the skin</li>
                            </ul>
                            <div class="d-flex align-items-center mt-3">
                                <span class="product-price me-3">KSh 1,800</span>
                                <a href="#" class="btn">Shop Now</a>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <img src="https://neutriherbs.com/cdn/shop/products/vitaminc-cleanser.jpg" alt="Vitamin C Face Cleanser" class="img-fluid rounded shadow" onerror="this.onerror=null; this.src='/static/images/product-placeholder.jpg';">
                        </div>
                    </div>
                </div>
                {% elif current_category == 'Toner' %}
                <div class="featured-product-banner">
                    <div class="row align-items-center">
                        <div class="col-md-7">
                            <h3>Our Best-Selling Toner</h3>
                            <p>Vitamin C Brightening & Glowing Skin Toner - For Moisturizing And Refining</p>
                            <p><strong>Key Benefits:</strong></p>
                            <ul>
                                <li>Balances skin pH after cleansing</li>
                                <li>Vitamin C for brighter complexion</li>
                                <li>Refines and tightens pores</li>
                                <li>Preps skin for better serum absorption</li>
                            </ul>
                            <div class="d-flex align-items-center mt-3">
                                <span class="product-original-price">KSh 2,400</span>
                                <span class="product-price me-3">KSh 2,200</span>
                                <a href="#" class="btn">Shop Now</a>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <img src="https://neutriherbs.com/cdn/shop/products/vitamin-c-toner.jpg" alt="Vitamin C Brightening Toner" class="img-fluid rounded shadow" onerror="this.onerror=null; this.src='/static/images/product-placeholder.jpg';">
                        </div>
                    </div>
                </div>
                {% elif current_category == 'Face Cream' %}
                <div class="featured-product-banner">
                    <div class="row align-items-center">
                        <div class="col-md-7">
                            <h3>Our Best-Selling Face Cream</h3>
                            <p>Vitamin C Brightening and Glow Cream - For Antioxidant And Skin Radiance</p>
                            <p><strong>Key Benefits:</strong></p>
                            <ul>
                                <li>24-hour hydration and moisture lock</li>
                                <li>Powerful antioxidant protection</li>
                                <li>Improves skin radiance and brightness</li>
                                <li>Suitable for all skin types</li>
                            </ul>
                            <div class="d-flex align-items-center mt-3">
                                <span class="product-price me-3">KSh 3,200</span>
                                <a href="#" class="btn">Shop Now</a>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <img src="https://neutriherbs.com/cdn/shop/products/vitamin-c-cream.jpg" alt="Vitamin C Brightening Cream" class="img-fluid rounded shadow" onerror="this.onerror=null; this.src='/static/images/product-placeholder.jpg';">
                        </div>
                    </div>
                </div>
                {% elif current_category == 'Body Wash' %}
                <div class="featured-product-banner">
                    <div class="row align-items-center">
                        <div class="col-md-7">
                            <h3>Our Best-Selling Body Wash</h3>
                            <p>Neutriherbs Skin Nourishing Body Wash - Gentle Cleansing With Natural Extracts</p>
                            <p><strong>Key Benefits:</strong></p>
                            <ul>
                                <li>Gently cleanses without stripping natural oils</li>
                                <li>Rich, luxurious lather for a spa-like experience</li>
                                <li>Plant-based cleansing agents</li>
                                <li>Leaves skin feeling soft and hydrated</li>
                            </ul>
                            <div class="d-flex align-items-center mt-3">
                                <span class="product-price me-3">KSh 2,000</span>
                                <a href="#" class="btn">Shop Now</a>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <img src="https://neutriherbs.com/cdn/shop/files/neutriherbs-best-body-wash-for-smooth-skin.jpg" alt="Neutriherbs Body Wash" class="img-fluid rounded shadow" onerror="this.onerror=null; this.src='/static/images/product-placeholder.jpg';">
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Skin Type Filter -->
        <div class="skin-type-filter">
            {% if current_category == 'Cleanser' %}
                <button class="skin-type-btn active" data-skin-type="all">All Cleansers</button>
                <button class="skin-type-btn" data-skin-type="dry">For Dry Skin</button>
                <button class="skin-type-btn" data-skin-type="oily">For Oily Skin</button>
                <button class="skin-type-btn" data-skin-type="sensitive">For Sensitive Skin</button>
                <button class="skin-type-btn" data-skin-type="combination">For Combination Skin</button>
            {% elif current_category == 'Toner' %}
                <button class="skin-type-btn active" data-skin-type="all">All Toners</button>
                <button class="skin-type-btn" data-skin-type="hydrating">Hydrating</button>
                <button class="skin-type-btn" data-skin-type="exfoliating">Exfoliating</button>
                <button class="skin-type-btn" data-skin-type="balancing">Balancing</button>
                <button class="skin-type-btn" data-skin-type="soothing">Soothing</button>
            {% elif current_category == 'Face Cream' %}
                <button class="skin-type-btn active" data-skin-type="all">All Moisturizers</button>
                <button class="skin-type-btn" data-skin-type="night">Night Cream</button>
                <button class="skin-type-btn" data-skin-type="day">Day Cream</button>
                <button class="skin-type-btn" data-skin-type="anti-aging">Anti-Aging</button>
                <button class="skin-type-btn" data-skin-type="oil-free">Oil-Free</button>
            {% elif current_category == 'Body Wash' %}
                <button class="skin-type-btn active" data-skin-type="all">All Body Washes</button>
                <button class="skin-type-btn" data-skin-type="exfoliating">Exfoliating</button>
                <button class="skin-type-btn" data-skin-type="hydrating">Hydrating</button>
                <button class="skin-type-btn" data-skin-type="fragrance-free">Fragrance-Free</button>
                <button class="skin-type-btn" data-skin-type="brightening">Brightening</button>
            {% else %}
                <button class="skin-type-btn active" data-skin-type="all">All Products</button>
                <button class="skin-type-btn" data-skin-type="dry">For Dry Skin</button>
                <button class="skin-type-btn" data-skin-type="oily">For Oily Skin</button>
                <button class="skin-type-btn" data-skin-type="sensitive">For Sensitive Skin</button>
            {% endif %}
        </div>
        
        <!-- Sorting Options -->
        <div class="d-flex justify-content-between align-items-center mb-4 bg-white p-3 rounded shadow-sm">
            <div>
                <p class="mb-0">Showing {{ products|length }} products</p>
                <small class="text-danger"><i class="fas fa-clock"></i> Limited time offers end when timer expires</small>
            </div>
            <div class="d-flex align-items-center">
                <label for="sort-by" class="form-label mb-0 me-2">Sort by:</label>
                <select class="form-select form-select-sm" id="sort-by">
                    <option value="default">Featured</option>
                    <option value="price-low">Price: Low to High</option>
                    <option value="price-high">Price: High to Low</option>
                    <option value="newest">Newest First</option>
                </select>
            </div>
        </div>
        
        <div class="products-wrapper">
            <div class="row g-4">
                {% for product in products %}
                    <div class="col-6 col-md-4 col-lg-3 product-item" 
                         data-price="{{ product.price }}" 
                         data-name="{{ product.name }}" 
                         data-date="{{ product.created_at|date:'U' }}"
                         data-skin-type="{% if 'dry' in product.name|lower %}dry{% elif 'oily' in product.name|lower %}oily{% elif 'sensitive' in product.name|lower %}sensitive{% elif 'combination' in product.name|lower %}combination{% else %}all{% endif %}">
                        <div class="product-card h-100">
                            {% if forloop.first %}
                                <div class="best-seller-badge">BEST SELLER</div>
                            {% endif %}
                            {% if forloop.counter == 2 %}
                                <div class="flash-sale-badge">FLASH SALE</div>
                            {% endif %}
                            {% if product.is_new %}
                                <div class="position-absolute top-0 start-0 bg-success text-white p-2 m-2 z-1">
                                    <small>NEW</small>
                                </div>
                            {% endif %}
                            {% if product.is_sale %}
                                <div class="position-absolute top-0 start-0 bg-danger text-white p-2 m-2 z-1">
                                    <small>SALE</small>
                                </div>
                            {% endif %}
                            <div class="product-img-container">
                                {% for image in product.images.all %}
                                    {% if image.is_main %}
                                        <img src="{{ image.image.url }}" alt="{{ product.name }}" class="product-img">
                                    {% endif %}
                                {% empty %}
                                    <div class="bg-light w-100 h-100 d-flex align-items-center justify-content-center">
                                        <i class="fas fa-image fa-3x text-secondary"></i>
                                    </div>
                                {% endfor %}
                                <div class="position-absolute top-0 end-0 m-2 z-1">
                                    <button class="btn btn-sm btn-light rounded-circle shadow quick-view" data-product-id="{{ product.id }}" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="product-info">
                                <h6 class="product-title">{{ product.name }}</h6>
                                <div class="product-rating mb-2">
                                    <span>â˜…â˜…â˜…â˜…â˜…</span>
                                    <small class="text-muted">({{ forloop.counter|add:25 }})</small>
                                </div>
                                
                                <!-- Stock Status -->
                                {% if forloop.counter == 1 or forloop.counter == 4 %}
                                    <div class="stock-status in-stock">
                                        <i class="fas fa-check-circle"></i> In Stock
                                    </div>
                                {% elif forloop.counter == 2 %}
                                    <div class="stock-status low-stock">
                                        <i class="fas fa-exclamation-circle"></i> Only 3 left!
                                    </div>
                                {% elif forloop.counter == 3 %}
                                    <div class="stock-status out-of-stock">
                                        <i class="fas fa-times-circle"></i> Out of Stock
                                    </div>
                                {% endif %}
                                
                                <div class="d-flex justify-content-center align-items-center mb-3">
                                    {% if product.original_price %}
                                        <span class="product-original-price">KSh {{ product.original_price }}</span>
                                        <span class="product-price">KSh {{ product.price }}</span>
                                        <span class="product-discount">-15%</span>
                                    {% else %}
                                        <span class="product-price">KSh {{ product.price }}</span>
                                    {% endif %}
                                </div>
                                <a href="{{ product.get_absolute_url }}" class="btn btn-outline-dark btn-sm w-100 mb-2">View Details</a>
                                
                                {% if forloop.counter != 3 %}
                                    <form action="{% url 'store:add_to_cart' product.id %}" method="post" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="add-to-cart-btn">
                                            <i class="fas fa-shopping-cart me-2"></i> Add to Cart
                                        </button>
                                    </form>
                                {% else %}
                                    <button class="btn btn-secondary w-100 mt-2" disabled>
                                        Out of Stock
                                    </button>
                                    <button class="btn btn-outline-dark btn-sm w-100 mt-2">
                                        <i class="fas fa-bell me-1"></i> Notify Me
                                    </button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% empty %}
                    <!-- Add mock products when no products are available from database -->
                    <!-- Mock Product 1 -->
                    <div class="col-6 col-md-4 col-lg-3 product-item" 
                         data-price="1599" 
                         data-name="Vitamin C Facial Cleanser" 
                         data-date="{% now "U" %}"
                         data-skin-type="all">
                        <div class="product-card h-100">
                            <div class="best-seller-badge">BEST SELLER</div>
                            <div class="product-img-container">
                                <img src="https://neutriherbs.com/cdn/shop/products/vitaminc-cleanser.jpg" alt="Vitamin C Facial Cleanser" class="product-img">
                                <div class="position-absolute top-0 end-0 m-2 z-1">
                                    <button class="btn btn-sm btn-light rounded-circle shadow quick-view" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                        <i class="fas fa-eye"></i>
                                    </button>
                        </div>
                            </div>
                            <div class="product-info">
                                <h6 class="product-title">Vitamin C Facial Cleanser</h6>
                                <div class="product-rating mb-2">
                                    <span>â˜…â˜…â˜…â˜…â˜…</span>
                                    <small class="text-muted">(34)</small>
                                </div>
                                <div class="stock-status in-stock">
                                    <i class="fas fa-check-circle"></i> In Stock
                                </div>
                                <div class="d-flex justify-content-center align-items-center mb-3">
                                    <span class="product-original-price">KSh 1,999</span>
                                    <span class="product-price">KSh 1,599</span>
                                    <span class="product-discount">-20%</span>
                                </div>
                                <div class="mt-auto product-actions">
                                    <a href="#" class="btn btn-outline-dark btn-sm w-100 mb-2">View Details</a>
                                    <form action="#" method="post" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="add-to-cart-btn">
                                            <i class="fas fa-shopping-cart me-2"></i> Add to Cart
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mock Product 2 -->
                    <div class="col-6 col-md-4 col-lg-3 product-item" 
                         data-price="2299" 
                         data-name="Hyaluronic Acid Serum" 
                         data-date="{% now "U" %}"
                         data-skin-type="dry">
                        <div class="product-card h-100">
                            <div class="flash-sale-badge">FLASH SALE</div>
                            <div class="product-img-container">
                                <img src="https://neutriherbs.com/cdn/shop/products/hyaluronic-acid-serum.jpg" alt="Hyaluronic Acid Serum" class="product-img">
                                <div class="position-absolute top-0 end-0 m-2 z-1">
                                    <button class="btn btn-sm btn-light rounded-circle shadow quick-view" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="product-info">
                                <h6 class="product-title">Hyaluronic Acid Serum</h6>
                                <div class="product-rating mb-2">
                                    <span>â˜…â˜…â˜…â˜…â˜…</span>
                                    <small class="text-muted">(28)</small>
                                </div>
                                <div class="stock-status low-stock">
                                    <i class="fas fa-exclamation-circle"></i> Only 3 left!
                                </div>
                                <div class="d-flex justify-content-center align-items-center mb-3">
                                    <span class="product-original-price">KSh 2,700</span>
                                    <span class="product-price">KSh 2,299</span>
                                    <span class="product-discount">-15%</span>
                                </div>
                                <div class="mt-auto product-actions">
                                    <a href="#" class="btn btn-outline-dark btn-sm w-100 mb-2">View Details</a>
                                    <form action="#" method="post" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="add-to-cart-btn">
                                            <i class="fas fa-shopping-cart me-2"></i> Add to Cart
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mock Product 3 -->
                    <div class="col-6 col-md-4 col-lg-3 product-item" 
                         data-price="2899" 
                         data-name="Retinol Night Cream" 
                         data-date="{% now "U" %}"
                         data-skin-type="all">
                        <div class="product-card h-100">
                            <div class="product-img-container">
                                <img src="https://neutriherbs.com/cdn/shop/products/retinol-cream.jpg" alt="Retinol Night Cream" class="product-img">
                                <div class="position-absolute top-0 end-0 m-2 z-1">
                                    <button class="btn btn-sm btn-light rounded-circle shadow quick-view" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="product-info">
                                <h6 class="product-title">Retinol Night Cream</h6>
                                <div class="product-rating mb-2">
                                    <span>â˜…â˜…â˜…â˜…â˜…</span>
                                    <small class="text-muted">(41)</small>
                                </div>
                                <div class="stock-status out-of-stock">
                                    <i class="fas fa-times-circle"></i> Out of Stock
                                </div>
                                <div class="d-flex justify-content-center align-items-center mb-3">
                                    <span class="product-price">KSh 2,899</span>
                                </div>
                                <div class="mt-auto product-actions">
                                    <a href="#" class="btn btn-outline-dark btn-sm w-100 mb-2">View Details</a>
                                    <button class="btn btn-secondary w-100 mt-2" disabled>
                                        Out of Stock
                                    </button>
                                    <button class="btn btn-outline-dark btn-sm w-100 mt-2">
                                        <i class="fas fa-bell me-1"></i> Notify Me
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mock Product 4 -->
                    <div class="col-6 col-md-4 col-lg-3 product-item" 
                         data-price="3599" 
                         data-name="Vitamin C Brightening Set" 
                         data-date="{% now "U" %}"
                         data-skin-type="all">
                        <div class="product-card h-100">
                            <div class="position-absolute top-0 start-0 bg-success text-white p-2 m-2 z-1">
                                <small>NEW</small>
                            </div>
                            <div class="product-img-container">
                                <img src="https://neutriherbs.com/cdn/shop/products/vitamin-c-set.jpg" alt="Vitamin C Brightening Set" class="product-img">
                                <div class="position-absolute top-0 end-0 m-2 z-1">
                                    <button class="btn btn-sm btn-light rounded-circle shadow quick-view" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="product-info">
                                <h6 class="product-title">Vitamin C Brightening Set</h6>
                                <div class="product-rating mb-2">
                                    <span>â˜…â˜…â˜…â˜…â˜…</span>
                                    <small class="text-muted">(19)</small>
                                </div>
                                <div class="stock-status in-stock">
                                    <i class="fas fa-check-circle"></i> In Stock
                                </div>
                                <div class="d-flex justify-content-center align-items-center mb-3">
                                    <span class="product-price">KSh 3,599</span>
                                </div>
                                <div class="mt-auto product-actions">
                                    <a href="#" class="btn btn-outline-dark btn-sm w-100 mb-2">View Details</a>
                                    <form action="#" method="post" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="add-to-cart-btn">
                                            <i class="fas fa-shopping-cart me-2"></i> Add to Cart
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mock Product 5 -->
                    <div class="col-6 col-md-4 col-lg-3 product-item" 
                         data-price="1899" 
                         data-name="Tea Tree Oil Cleanser" 
                         data-date="{% now "U" %}"
                         data-skin-type="oily">
                        <div class="product-card h-100">
                            <div class="product-img-container">
                                <img src="https://neutriherbs.com/cdn/shop/products/tea-tree-cleanser.jpg" alt="Tea Tree Oil Cleanser" class="product-img">
                                <div class="position-absolute top-0 end-0 m-2 z-1">
                                    <button class="btn btn-sm btn-light rounded-circle shadow quick-view" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="product-info">
                                <h6 class="product-title">Tea Tree Oil Cleanser</h6>
                                <div class="product-rating mb-2">
                                    <span>â˜…â˜…â˜…â˜…â˜…</span>
                                    <small class="text-muted">(23)</small>
                                </div>
                                <div class="stock-status in-stock">
                                    <i class="fas fa-check-circle"></i> In Stock
                                </div>
                                <div class="d-flex justify-content-center align-items-center mb-3">
                                    <span class="product-price">KSh 1,899</span>
                                </div>
                                <div class="mt-auto product-actions">
                                    <a href="#" class="btn btn-outline-dark btn-sm w-100 mb-2">View Details</a>
                                    <form action="#" method="post" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="add-to-cart-btn">
                                            <i class="fas fa-shopping-cart me-2"></i> Add to Cart
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mock Product 6 -->
                    <div class="col-6 col-md-4 col-lg-3 product-item" 
                         data-price="1799" 
                         data-name="Aloe Vera Toner" 
                         data-date="{% now "U" %}"
                         data-skin-type="sensitive">
                        <div class="product-card h-100">
                            <div class="position-absolute top-0 start-0 bg-danger text-white p-2 m-2 z-1">
                                <small>SALE</small>
                            </div>
                            <div class="product-img-container">
                                <img src="https://neutriherbs.com/cdn/shop/products/aloe-toner.jpg" alt="Aloe Vera Toner" class="product-img">
                                <div class="position-absolute top-0 end-0 m-2 z-1">
                                    <button class="btn btn-sm btn-light rounded-circle shadow quick-view" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="product-info">
                                <h6 class="product-title">Aloe Vera Toner</h6>
                                <div class="product-rating mb-2">
                                    <span>â˜…â˜…â˜…â˜…â˜…</span>
                                    <small class="text-muted">(31)</small>
                                </div>
                                <div class="stock-status in-stock">
                                    <i class="fas fa-check-circle"></i> In Stock
                                </div>
                                <div class="d-flex justify-content-center align-items-center mb-3">
                                    <span class="product-original-price">KSh 2,100</span>
                                    <span class="product-price">KSh 1,799</span>
                                    <span class="product-discount">-15%</span>
                                </div>
                                <div class="mt-auto product-actions">
                                    <a href="#" class="btn btn-outline-dark btn-sm w-100 mb-2">View Details</a>
                                    <form action="#" method="post" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="add-to-cart-btn">
                                            <i class="fas fa-shopping-cart me-2"></i> Add to Cart
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mock Product 7 -->
                    <div class="col-6 col-md-4 col-lg-3 product-item" 
                         data-price="3999" 
                         data-name="Snail Mucin Repair Set" 
                         data-date="{% now "U" %}"
                         data-skin-type="all">
                        <div class="product-card h-100">
                            <div class="product-img-container">
                                <img src="https://neutriherbs.com/cdn/shop/products/snail-set.jpg" alt="Snail Mucin Repair Set" class="product-img">
                                <div class="position-absolute top-0 end-0 m-2 z-1">
                                    <button class="btn btn-sm btn-light rounded-circle shadow quick-view" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="product-info">
                                <h6 class="product-title">Snail Mucin Repair Set</h6>
                                <div class="product-rating mb-2">
                                    <span>â˜…â˜…â˜…â˜…â˜…</span>
                                    <small class="text-muted">(45)</small>
                                </div>
                                <div class="stock-status in-stock">
                                    <i class="fas fa-check-circle"></i> In Stock
                                </div>
                                <div class="d-flex justify-content-center align-items-center mb-3">
                                    <span class="product-price">KSh 3,999</span>
                                </div>
                                <div class="mt-auto product-actions">
                                    <a href="#" class="btn btn-outline-dark btn-sm w-100 mb-2">View Details</a>
                                    <form action="#" method="post" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="add-to-cart-btn">
                                            <i class="fas fa-shopping-cart me-2"></i> Add to Cart
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mock Product 8 -->
                    <div class="col-6 col-md-4 col-lg-3 product-item" 
                         data-price="2499" 
                         data-name="Gentle Exfoliating Scrub" 
                         data-date="{% now "U" %}"
                         data-skin-type="combination">
                        <div class="product-card h-100">
                            <div class="product-img-container">
                                <img src="https://neutriherbs.com/cdn/shop/products/exfoliating-scrub.jpg" alt="Gentle Exfoliating Scrub" class="product-img">
                                <div class="position-absolute top-0 end-0 m-2 z-1">
                                    <button class="btn btn-sm btn-light rounded-circle shadow quick-view" data-bs-toggle="modal" data-bs-target="#quickViewModal">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="product-info">
                                <h6 class="product-title">Gentle Exfoliating Scrub</h6>
                                <div class="product-rating mb-2">
                                    <span>â˜…â˜…â˜…â˜…â˜…</span>
                                    <small class="text-muted">(27)</small>
                                </div>
                                <div class="stock-status low-stock">
                                    <i class="fas fa-exclamation-circle"></i> Only 2 left!
                                </div>
                                <div class="d-flex justify-content-center align-items-center mb-3">
                                    <span class="product-price">KSh 2,499</span>
                                </div>
                                <div class="mt-auto product-actions">
                                    <a href="#" class="btn btn-outline-dark btn-sm w-100 mb-2">View Details</a>
                                    <form action="#" method="post" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="add-to-cart-btn">
                                            <i class="fas fa-shopping-cart me-2"></i> Add to Cart
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
        
        <!-- Additional Products - This would be displayed if there were more products -->
        <div class="text-center mt-5">
            <button class="btn btn-dark px-4 py-3">Load More Products</button>
        </div>
        
        <!-- Urgency Banner -->
        <div class="limited-offer-banner mt-5">
            <h4>Don't miss out! ðŸ”¥ 15% OFF ends when the timer hits zero!</h4>
            <p>Use code <strong>{% if current_category == 'Cleanser' %}CLEAN15{% elif current_category == 'Toner' %}TONE15{% elif current_category == 'Face Cream' %}CREAM15{% elif current_category == 'Body Wash' %}BODY15{% else %}SAVE15{% endif %}</strong> at checkout</p>
            <a href="#products-section" class="btn btn-dark px-4 py-2 mt-2">Shop Now</a>
        </div>
    </div>
</section>

<!-- Complementary Products Section -->
<section class="py-5 bg-light">
    <div class="container">
        <h2 class="text-center mb-2">Complete Your Skincare Routine</h2>
        <p class="text-center text-muted mb-5">Pair with these products for best results</p>
        <div class="card border-0 shadow">
            <div class="card-body p-4">
                <div class="row g-4">
                    {% if current_category == 'Cleanser' %}
                        <div class="col-md-4">
                            <div class="card h-100 border-0 shadow-sm text-center">
                                <div class="card-body p-4">
                                    <i class="fas fa-tint fa-3x text-primary mb-3"></i>
                                    <h4>Toner</h4>
                                    <p class="text-muted mb-3">Balance your skin's pH after cleansing</p>
                                    <a href="{% url 'store:toner_category' %}" class="btn btn-dark">Shop Toners</a>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    
                    {% if current_category != 'Serum' %}
                        <div class="col-md-4">
                            <div class="card h-100 border-0 shadow-sm text-center">
                                <div class="card-body p-4">
                                    <i class="fas fa-flask fa-3x text-primary mb-3"></i>
                                    <h4>Serum</h4>
                                    <p class="text-muted mb-3">Apply targeted treatments for your skin concerns</p>
                                    <a href="{% url 'store:serum_category' %}" class="btn btn-dark">Shop Serums</a>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    
                    {% if current_category != 'Face Cream' %}
                        <div class="col-md-4">
                            <div class="card h-100 border-0 shadow-sm text-center">
                                <div class="card-body p-4">
                                    <i class="fas fa-cookie fa-3x text-primary mb-3"></i>
                                    <h4>Moisturizer</h4>
                                    <p class="text-muted mb-3">Lock in hydration and protect your skin</p>
                                    <a href="{% url 'store:face_cream_category' %}" class="btn btn-dark">Shop Moisturizers</a>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- WhatsApp Chat Button -->
<div class="position-fixed" style="bottom: 20px; right: 20px; z-index: 1000;">
    <a href="https://wa.me/254700000000" target="_blank" class="btn btn-gold rounded-circle shadow p-3" style="width: 60px; height: 60px; background-color: #d4af37;">
        <i class="fab fa-whatsapp fa-2x text-white"></i>
    </a>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Countdown Timer
    function updateCountdown() {
        // Set end date to 2 days from now
        const endDate = new Date();
        endDate.setDate(endDate.getDate() + 2);
        
        // Update countdown every second
        function update() {
            const now = new Date();
            const diff = endDate - now;
            
            // Calculate days, hours, minutes, seconds
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            // Update DOM
            document.getElementById('days').textContent = days.toString().padStart(2, '0');
            document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
            
            // If countdown is over
            if (diff <= 0) {
                clearInterval(interval);
                document.getElementById('days').textContent = '00';
                document.getElementById('hours').textContent = '00';
                document.getElementById('minutes').textContent = '00';
                document.getElementById('seconds').textContent = '00';
            }
        }
        
        // Initial call
        update();
        
        // Update every second
        const interval = setInterval(update, 1000);
    }
    
    // Start countdown
    if (document.getElementById('days')) {
        updateCountdown();
    }
    
    // Product sorting functionality
    const sortSelect = document.getElementById('sort-by');
    const productsContainer = document.querySelector('.row.g-4');
    
    sortSelect.addEventListener('change', function() {
        const sortValue = this.value;
        const productItems = Array.from(document.querySelectorAll('.product-item'));
        
        productItems.sort(function(a, b) {
            switch(sortValue) {
                case 'price-low':
                    return parseFloat(a.dataset.price) - parseFloat(b.dataset.price);
                case 'price-high':
                    return parseFloat(b.dataset.price) - parseFloat(a.dataset.price);
                case 'newest':
                    return parseInt(b.dataset.date) - parseInt(a.dataset.date);
                default:
                    return 0;
            }
        });
        
        // Remove all products
        productItems.forEach(item => item.remove());
        
        // Append sorted products
        productItems.forEach(item => productsContainer.appendChild(item));
    });
    
    // Skin type filter functionality
    const skinTypeButtons = document.querySelectorAll('.skin-type-btn');
    const productItems = document.querySelectorAll('.product-item');
    
    skinTypeButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Remove active class from all buttons
            skinTypeButtons.forEach(btn => btn.classList.remove('active'));
            
            // Add active class to clicked button
            this.classList.add('active');
            
            const skinType = this.getAttribute('data-skin-type');
            
            // Filter products
            productItems.forEach(item => {
                if (skinType === 'all' || item.getAttribute('data-skin-type') === skinType) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        });
    });
    
    // Add to cart functionality for AJAX submission
    const addToCartForms = document.querySelectorAll('.add-to-cart-form');
    
    addToCartForms.forEach(form => {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const url = this.action;
            const button = this.querySelector('button');
            const originalButtonText = button.innerHTML;
            
            // Show loading state
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Adding...';
            button.disabled = true;
            
            fetch(url, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Show success message
                    button.innerHTML = '<i class="fas fa-check"></i> Added!';
                    button.classList.add('bg-success');
                    
                    // Update cart counter if it exists
                    const cartCounter = document.querySelector('.cart-counter');
                    if (cartCounter) {
                        cartCounter.textContent = data.item_count;
                    }
                    
                    // Reset after delay
                    setTimeout(() => {
                        button.innerHTML = '<i class="fas fa-shopping-cart me-2"></i> Add to Cart';
                        button.classList.remove('bg-success');
                        button.disabled = false;
                    }, 2000);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                button.innerHTML = originalButtonText;
                button.disabled = false;
            });
        });
    });
});
</script>
{% endblock %} 